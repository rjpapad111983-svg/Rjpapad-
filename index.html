<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RJ Papad - MLM Wallet</title>
<style>
:root{
  --accent:#ffb300;
  --bg:#fff8dc;
  --card:#fff;
  --muted:#666;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,Roboto,Arial;background:var(--bg);color:#222;}
header{background:var(--accent);color:#fff;padding:12px 14px;display:flex;align-items:center;position:sticky;top:0;z-index:5;}
.menu-btn{font-size:26px;margin-right:10px;cursor:pointer}
header h1{flex:1;font-size:18px;margin:0;text-align:center}
main{padding:16px;max-width:900px;margin:auto}
.card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 14px rgba(0,0,0,0.08);margin-bottom:18px}
button,input{font-size:15px;padding:10px;border-radius:8px;border:1px solid #ccc}
button.primary{background:var(--accent);border:none;color:#fff}
button.ghost{background:#f5f5f5;border:none}
.langbar{display:flex;gap:8px;margin-bottom:10px}
.langbar button{background:#fff;border:1px solid #ddd;border-radius:999px;padding:6px 12px}
.banner img{width:100%;border-radius:12px;display:block}
.drawer{position:fixed;top:0;bottom:0;left:0;width:260px;background:#fff;box-shadow:2px 0 14px rgba(0,0,0,0.15);transform:translateX(-120%);transition:.3s;padding:18px;z-index:50}
.drawer.open{transform:translateX(0)}
.drawer button{display:block;width:100%;text-align:left;margin-bottom:10px;padding:10px;border:none;border-radius:8px;background:#fafafa}
#logo-page{position:fixed;inset:0;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100}
#logo-page img{max-width:80%;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.15)}
#logo-page.hidden{display:none}
.big-amount{font-size:26px;color:#d2691e;font-weight:bold}
.muted{color:var(--muted)}
.tree-node{padding:10px;border-radius:8px;background:#fff;margin:8px 0;display:flex;justify-content:space-between;align-items:center}
.plusbtn{border:2px solid #4aa3ff;border-radius:50%;width:36px;height:36px;color:#4aa3ff;background:#fff}
.note{font-size:13px;color:#777;margin-top:8px}
</style>
</head>
<body>
<header>
  <div class="menu-btn" id="menuBtn">â˜°</div>
  <h1>RJ Papad</h1>
</header>

<!-- Drawer -->
<div class="drawer" id="drawer">
  <h3>Menu</h3>
  <div id="menuLoggedAs" class="muted" style="margin-bottom:8px"></div>
  <button id="menuWalletBtn">ğŸ’° Wallet</button>
  <button id="menuMyTeamBtn">ğŸ§‘â€ğŸ¤â€ğŸ§‘ My Team</button>
  <button id="menuTreeBtn">ğŸŒ³ MLM Tree</button>
  <button id="menuOrderBtn">ğŸ›’ Place Order</button>
  <hr/>
  <button id="menuAdminBtn">ğŸ” Admin</button>
  <button id="menuLogoutBtn">ğŸšª Logout</button>
</div>

<!-- Logo Page -->
<div id="logo-page">
  <img id="logoImg" src="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_0000000040986208ae9fdd85a3a3cbc8.png" alt="Logo">
  <div class="langbar">
    <button id="lang-hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</button>
    <button id="lang-en">English</button>
    <button id="lang-gu">àª—à«àªœàª°àª¾àª¤à«€</button>
  </div>
  <button class="primary" id="logoHideBtn">à¤œà¤¾à¤°à¥€ à¤°à¤–à¥‡à¤‚ / Continue</button>
</div>

<main>
  <!-- Banners -->
  <div id="bannersWrap" class="card">
    <div class="langbar">
      <button id="hiBtn">à¤¹à¤¿à¤¨à¥à¤¦à¥€</button>
      <button id="enBtn">English</button>
      <button id="guBtn">àª—à«àªœàª°àª¾àª¤à«€</button>
    </div>
    <div class="banner"><img id="bannerImg" src="" alt="banner"></div>
    <div id="bannerText" class="muted">RJ à¤ªà¤¾à¤ªà¤¡à¤¼ â€” à¤¸à¥à¤µà¤¾à¤¦ à¤®à¥‡à¤‚ à¤–à¤¾à¤¸</div>
  </div>

  <!-- Wallet -->
  <div id="walletCard" class="card" style="display:none">
    <h3>My Wallet</h3>
    <div id="walletAmount" class="big-amount">â‚¹0</div>
    <div id="walletBank" class="muted">HDFC Bank â€¢ demo@upi</div>
    <div style="height:10px"></div>
    <input id="addAmountInp" placeholder="Add amount â‚¹">
    <button class="primary" id="addAmountBtn">Add</button>
    <div style="height:10px"></div>
    <button class="ghost" id="withdrawBtn">Withdraw (Request)</button>
    <div class="note">10% fee applies. Admin approves manually.</div>
  </div>

  <!-- My Team -->
  <div id="myTeamCard" class="card" style="display:none">
    <h3>My Team</h3>
    <div id="teamList"></div>
  </div>

  <!-- Tree -->
  <div id="treeCard" class="card" style="display:none">
    <h3>MLM Tree</h3>
    <div id="treeCanvasWrap"></div>
  </div>

  <!-- Admin -->
  <div id="adminPanel" class="card" style="display:none">
    <h3>Admin Panel</h3>
    <ul id="withdrawRequests"></ul>
  </div>
</main>

<script>
/* ================== CONFIG ================== */
const ADMIN_PASSWORD="Rjpapad@2025";
/* Banners: Hindi and English (user provided english link used here) */
const BANNER_HI="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_00000000de7861faafb1b8052e9bd122%20(1).png";
const BANNER_EN="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_00000000aac061fdacd52dbbf8a83410.png";
const LOGO_IMG="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_0000000040986208ae9fdd85a3a3cbc8.png";
/* ================== STORAGE KEYS ================== */
const KEY_USERS = "rp_users_v1";
const KEY_WITHDRAWS = "rp_withdraws_v1";
const KEY_ME = "rp_me";
const KEY_LANG = "rp_lang";

/* load/save helpers */
function load(key, def){ try{return JSON.parse(localStorage.getItem(key)||"null")||def;}catch(e){return def} }
function save(key,obj){ localStorage.setItem(key, JSON.stringify(obj)); }

/* data */
let users = load(KEY_USERS, {});
let withdraws = load(KEY_WITHDRAWS, []);
let me = load(KEY_ME, null);
let currentLang = localStorage.getItem(KEY_LANG) || "hi";

/* Auto save every 2s */
function saveAll(){ save(KEY_USERS, users); save(KEY_WITHDRAWS, withdraws); save(KEY_ME, me); localStorage.setItem(KEY_LANG, currentLang); }
setInterval(saveAll,2000);

/* UI refs */
const menuBtn = document.getElementById("menuBtn");
const drawer = document.getElementById("drawer");
const menuWalletBtn = document.getElementById("menuWalletBtn");
const menuMyTeamBtn = document.getElementById("menuMyTeamBtn");
const menuTreeBtn = document.getElementById("menuTreeBtn");
const menuOrderBtn = document.getElementById("menuOrderBtn");
const menuAdminBtn = document.getElementById("menuAdminBtn");
const menuLogoutBtn = document.getElementById("menuLogoutBtn");
const logoImg = document.getElementById("logoImg");
const logoHideBtn = document.getElementById("logoHideBtn");

const bannersWrap = document.getElementById("bannersWrap");
const bannerImg = document.getElementById("bannerImg");
const bannerText = document.getElementById("bannerText");

const walletCard = document.getElementById("walletCard");
const walletAmount = document.getElementById("walletAmount");
const addAmountInp = document.getElementById("addAmountInp");
const addAmountBtn = document.getElementById("addAmountBtn");
const withdrawBtn = document.getElementById("withdrawBtn");

const myTeamCard = document.getElementById("myTeamCard");
const teamList = document.getElementById("teamList");

const treeCard = document.getElementById("treeCard");
const treeCanvasWrap = document.getElementById("treeCanvasWrap");

const adminPanel = document.getElementById("adminPanel");
const withdrawRequests = document.getElementById("withdrawRequests");

/* init UI */
menuBtn.onclick = ()=> drawer.classList.toggle("open");
menuLogoutBtn.onclick = ()=>{ me=null; saveAll(); location.reload(); };
logoImg.src = LOGO_IMG;
logoHideBtn.onclick = ()=> document.getElementById("logo-page").classList.add("hidden");

/* language */
function setLang(lang){
  currentLang = lang;
  if(lang === "hi"){ bannerImg.src = BANNER_HI; bannerText.innerText = "RJ à¤ªà¤¾à¤ªà¤¡à¤¼ â€” à¤¸à¥à¤µà¤¾à¤¦ à¤®à¥‡à¤‚ à¤–à¤¾à¤¸"; }
  else if(lang === "en"){ bannerImg.src = BANNER_EN; bannerText.innerText = "RJ Papad â€” Homemade taste"; }
  else { bannerImg.src = BANNER_HI; bannerText.innerText = "RJ àªªàª¾àªªàª¡ â€” àª¸à«àªµàª¾àª¦àª®àª¾àª‚ àª–àª¾àª¸"; }
  saveAll();
}
document.getElementById("hiBtn").onclick = ()=> setLang("hi");
document.getElementById("enBtn").onclick = ()=> setLang("en");
document.getElementById("guBtn").onclick = ()=> setLang("gu");
document.getElementById("lang-hi").onclick = ()=> setLang("hi");
document.getElementById("lang-en").onclick = ()=> setLang("en");
document.getElementById("lang-gu").onclick = ()=> setLang("gu");
setLang(currentLang);

/* show/hide sections */
function showSection(s){
  bannersWrap.style.display = "none";
  walletCard.style.display = "none";
  myTeamCard.style.display = "none";
  treeCard.style.display = "none";
  adminPanel.style.display = "none";
  if(s==="wallet") walletCard.style.display = "block";
  if(s==="team") myTeamCard.style.display = "block";
  if(s==="tree") treeCard.style.display = "block";
  if(s==="admin") adminPanel.style.display = "block";
  if(s==="home") bannersWrap.style.display = "block";
}

/* Menu handlers */
menuWalletBtn.onclick = ()=>{ drawer.classList.remove("open"); if(!me) return alert("Please login first"); showSection("wallet"); updateWallet(); }
menuMyTeamBtn.onclick = ()=>{ drawer.classList.remove("open"); if(!me) return alert("Please login first"); showSection("team"); renderTeam(); }
menuTreeBtn.onclick = ()=>{ drawer.classList.remove("open"); if(!me) return alert("Please login first"); showSection("tree"); renderTree(); }
menuAdminBtn.onclick = ()=>{
  const pwd = prompt("Enter admin password:");
  if(pwd === ADMIN_PASSWORD){ drawer.classList.remove("open"); showSection("admin"); renderWithdraws(); }
  else alert("Wrong password");
};
menuOrderBtn.onclick = ()=>{
  drawer.classList.remove("open");
  if(!me) return alert("Login first");
  // simulate placing order: give commission to sponsor (parent)
  const sponsor = users[me.mobile] && users[me.mobile].parent;
  if(sponsor && users[sponsor]){
    users[sponsor].balance = (users[sponsor].balance||0) + 50; // fixed commission demo
    saveAll();
    alert("Order placed â€” â‚¹50 commission added to sponsor.");
  } else alert("Order placed â€” no sponsor found to credit.");
}

/* Wallet functions */
function updateWallet(){
  if(!me) return;
  const u = users[me.mobile] || {balance:0};
  walletAmount.innerText = "â‚¹" + (u.balance || 0);
}
addAmountBtn.onclick = ()=>{
  if(!me) return alert("Login first");
  const amt = parseFloat(addAmountInp.value);
  if(!amt || amt <= 0) return alert("Enter valid amount");
  users[me.mobile].balance = (users[me.mobile].balance||0) + amt;
  addAmountInp.value = "";
  saveAll(); updateWallet();
};
withdrawBtn.onclick = ()=>{
  if(!me) return alert("Login first");
  const amt = parseFloat(prompt("Withdraw amount?"));
  if(!amt || amt <= 0) return;
  const u = users[me.mobile];
  if(amt > (u.balance||0)) return alert("Not enough balance");
  const fee = Math.round(amt * 0.10);
  u.balance = (u.balance||0) - amt;
  withdraws.push({ id: Date.now(), mobile: me.mobile, amount: amt, fee, after: amt - fee, status: "pending" });
  saveAll(); updateWallet(); alert("Withdraw requested (10% fee applied). Admin will approve.");
};

/* Team / Tree rendering */
function renderTeam(){
  teamList.innerHTML = "";
  if(!me) return;
  const u = users[me.mobile] || {children:[]};
  (u.children||[]).forEach(childMobile=>{
    const div = document.createElement("div");
    div.className = "tree-node";
    const name = users[childMobile] ? (users[childMobile].name || childMobile) : childMobile;
    div.innerHTML = `<div> ${getEmojiForUser(childMobile)} ${name}</div><button class='plusbtn'>[+]</button>`;
    div.querySelector(".plusbtn").onclick = ()=> {
      // when plus clicked, show child's children (simple expand demo)
      const c = users[childMobile] && users[childMobile].children || [];
      if(!c.length) return alert("No sub-team");
      const popup = document.createElement("div"); popup.style.position="fixed"; popup.style.left="20%"; popup.style.top="20%"; popup.style.padding="16px"; popup.style.background="#fff"; popup.style.boxShadow="0 8px 20px rgba(0,0,0,0.2)"; popup.innerHTML = `<b>Team of ${users[childMobile].name||childMobile}</b><br><div>${c.map(x=>getEmojiForUser(x)+" "+(users[x].name||x)).join("<br>")}</div><div style="margin-top:8px"><button id="closePop">Close</button></div>`;
      document.body.appendChild(popup);
      document.getElementById("closePop").onclick = ()=> popup.remove();
    };
    teamList.appendChild(div);
  });
}

function renderTree(){
  treeCanvasWrap.innerHTML = "";
  if(!me) return;
  const root = users[me.mobile];
  if(!root) return;
  const container = document.createElement("div");
  container.style.textAlign="center";
  const rootCard = document.createElement("div");
  rootCard.className="card";
  rootCard.innerText = (root.name||me.mobile);
  container.appendChild(rootCard);
  const line = document.createElement("div");
  line.style.display="flex"; line.style.justifyContent="center"; line.style.gap="10px"; line.style.marginTop="12px";
  (root.children||[]).forEach(m=>{
    const ccard = document.createElement("div");
    ccard.className="card";
    ccard.innerText = users[m] ? (users[m].name || m) : m;
    line.appendChild(ccard);
  });
  container.appendChild(line);
  treeCanvasWrap.appendChild(container);
}

/* Admin withdraws */
function renderWithdraws(){
  withdrawRequests.innerHTML="";
  withdraws.forEach(w=>{
    const li = document.createElement("li");
    li.innerHTML = `${w.mobile} â†’ â‚¹${w.amount} (fee â‚¹${w.fee}) â€” ${w.status} `;
    if(w.status === "pending"){
      const a = document.createElement("button"); a.textContent = "Approve";
      a.onclick = ()=>{ w.status="approved"; saveAll(); renderWithdraws(); alert("Approved. Please send payment manually to user: check their bank/upi details."); }
      li.appendChild(a);
    }
    withdrawRequests.appendChild(li);
  });
}

/* small helper */
function getEmojiForUser(mobile){
  const u = users[mobile];
  if(!u || !u.gender) return "ğŸ‘¤";
  return (u.gender==="female") ? "ğŸ‘©" : "ğŸ‘¨";
}

/* Demo data (only if empty) */
if(Object.keys(users).length === 0){
  users["9990000001"] = { mobile:"9990000001", name:"Rajesh Parmar", balance:1500, children:["9990000002","9990000003"] };
  users["9990000002"] = { mobile:"9990000002", name:"Maan", balance:200, parent:"9990000001", gender:"male" };
  users["9990000003"] = { mobile:"9990000003", name:"Bhavna", balance:100, parent:"9990000001", gender:"female" };
  me = { mobile:"9990000001" };
  saveAll();
}

/* initial UI state */
updateWallet();
showSection("home");
document.getElementById("menuLoggedAs").innerText = me ? ("Logged as: " + (users[me.mobile] ? (users[me.mobile].name || me.mobile) : me.mobile)) : "Not logged";

/* expose for debugging (optional) */
window._rp = { users, me, withdraws, saveAll };

/* initial banner load (ensures banner shows immediately) */
setLang(currentLang);

</script>
</body>
</html>
