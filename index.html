<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>RJ Papad ‚Äî Wallet / Team</title>
<style>
:root{--accent:#ffb300;--bg:#fff8dc;--card:#fff;--muted:#666}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,Roboto,Arial;background:var(--bg);color:#222}
header{background:var(--accent);color:#fff;padding:12px 14px;display:flex;align-items:center;gap:8px;position:sticky;top:0;z-index:10}
.menu-btn{font-size:24px;cursor:pointer}
.brand{flex:1;text-align:center;font-weight:700}
.container{max-width:920px;margin:16px auto;padding:0 14px}
.card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 16px rgba(0,0,0,0.06);margin-bottom:16px}
input,button{font-size:15px;padding:10px;border-radius:8px;border:1px solid #ddd}
button.primary{background:var(--accent);border:none;color:#fff}
button.ghost{background:#f5f5f5;border:none}
.small{color:var(--muted);font-size:13px}
.hidden{display:none}
.banner img{width:100%;border-radius:12px;display:block}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border:1px solid #eee;padding:8px;text-align:left}
.drawer{position:fixed;left:0;top:0;bottom:0;width:300px;background:#fff;box-shadow:2px 0 18px rgba(0,0,0,0.12);transform:translateX(-120%);transition:transform .25s;z-index:50;padding:18px}
.drawer.open{transform:translateX(0)}
#overlay{position:fixed;inset:0;background:rgba(0,0,0,0.25);display:none;z-index:40}
</style>
</head>
<body>

<header>
  <div class="menu-btn" id="menuToggle">‚ò∞</div>
  <div class="brand">RJ Papad</div>
</header>

<div id="drawer" class="drawer">
  <h3>Menu</h3>
  <div id="loggedAs" class="small" style="margin-bottom:10px">Not logged</div>
  <button id="btnWallet">üí∞ Wallet</button>
  <button id="btnMyTeam">üë• My Team</button>
  <button id="btnTree">üå≥ MLM Tree</button>
  <button id="btnOrder">üõí Place Order</button>
  <hr>
  <button id="btnAdmin">üîê Admin</button>
  <button id="btnLogout">üö™ Logout</button>
</div>
<div id="overlay"></div>

<div class="container">

  <!-- Register/Login -->
  <div id="authCard" class="card">
    <h2 id="authTitle">Register / Login</h2>

    <div id="fullRegisterBlock" class="hidden">
      <input id="reg_name" placeholder="‡§®‡§æ‡§Æ (optional)"><br><br>
      <input id="reg_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞"><br><br>
      <input id="reg_parent" placeholder="Parent (optional)">
      <br><br>
      <button id="registerBtn" class="primary">Register</button>
      <button id="registerCancelBtn" class="ghost">Cancel</button>
    </div>

    <div id="loginOnlyBlock" class="hidden">
      <input id="login_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡•á Login"><br><br>
      <button id="loginOnlyBtn" class="primary">Login</button>
      <button id="showRegisterForJoinBtn" class="ghost">New Register</button>
    </div>

    <div id="authMsg" class="small" style="margin-top:8px;color:#b00"></div>
  </div>

  <!-- Wallet -->
  <div id="walletArea" class="card hidden">
    <h3>My Wallet</h3>
    <div style="font-size:22px;font-weight:bold">‚Çπ<span id="bal">0</span></div>
    <br>

    <input id="addAmt" placeholder="Add ‚Çπ amount">
    <button id="addBtn" class="primary">Add</button>
    <br><br>

    <h4>Transfer to another user</h4>
    <input id="t_mobile" placeholder="Mobile number"><br><br>
    <input id="t_amount" placeholder="Amount ‚Çπ"><br><br>
    <button id="transferBtn" class="primary">Transfer</button>
    <div id="transferMsg" class="small"></div>
    <br><hr>

    <button id="withdrawBtn" class="ghost">Withdraw (Request)</button>
    <div id="walletMsg" class="small" style="margin-top:8px"></div>
    <hr>

    <h4>My Bank Details</h4>
    <input id="bank_name" placeholder="Bank Name"><br><br>
    <input id="bank_acc" placeholder="Account Number"><br><br>
    <input id="bank_ifsc" placeholder="IFSC Code"><br><br>
    <input id="bank_upi" placeholder="UPI ID (optional)"><br><br>
    <button id="saveBankBtn" class="primary">Save Bank Info</button>
    <div id="bankMsg" class="small" style="margin-top:8px;color:green"></div>
  </div>

  <!-- Team -->
  <div id="teamArea" class="card hidden">
    <h3>My Team</h3>
    <div id="teamList"></div>
  </div>

  <!-- Tree -->
  <div id="treeArea" class="card hidden">
    <h3>MLM Tree</h3>
    <div id="treeView"></div>
  </div>

  <!-- Admin -->
  <div id="adminArea" class="card hidden">
    <h3>Admin</h3>
    <div id="requests"></div>
  </div>
</div>

<script>
const ADMIN_PWD="Rjpapad@2025";
const KEY_USERS="users_v7",KEY_ME="me_v7",KEY_WDS="wd_v7";
let users=JSON.parse(localStorage.getItem(KEY_USERS)||"{}");
let me=JSON.parse(localStorage.getItem(KEY_ME)||"null");
let withdraws=JSON.parse(localStorage.getItem(KEY_WDS)||"[]");
function save(){localStorage.setItem(KEY_USERS,JSON.stringify(users));localStorage.setItem(KEY_ME,JSON.stringify(me));localStorage.setItem(KEY_WDS,JSON.stringify(withdraws));}
setInterval(save,2000);

const authCard=document.getElementById("authCard"),
walletArea=document.getElementById("walletArea"),
teamArea=document.getElementById("teamArea"),
treeArea=document.getElementById("treeArea"),
adminArea=document.getElementById("adminArea");

function hideAll(){walletArea.classList.add("hidden");teamArea.classList.add("hidden");treeArea.classList.add("hidden");adminArea.classList.add("hidden");}
function openSection(x){hideAll();if(x==="wallet")walletArea.classList.remove("hidden");if(x==="team")teamArea.classList.remove("hidden");if(x==="tree")treeArea.classList.remove("hidden");if(x==="admin")adminArea.classList.remove("hidden");}

document.getElementById("btnWallet").onclick=()=>openSection("wallet");
document.getElementById("btnMyTeam").onclick=()=>openSection("team");
document.getElementById("btnTree").onclick=()=>openSection("tree");
document.getElementById("btnAdmin").onclick=()=>openSection("admin");
document.getElementById("btnLogout").onclick=()=>{me=null;save();location.reload();};

const regName=document.getElementById("reg_name"),
regMobile=document.getElementById("reg_mobile"),
regParent=document.getElementById("reg_parent"),
registerBtn=document.getElementById("registerBtn"),
registerCancelBtn=document.getElementById("registerCancelBtn"),
loginOnlyBtn=document.getElementById("loginOnlyBtn"),
loginMobile=document.getElementById("login_mobile"),
authMsg=document.getElementById("authMsg");

function showAuth(){if(Object.keys(users).length===0){document.getElementById("fullRegisterBlock").classList.remove("hidden");document.getElementById("loginOnlyBlock").classList.add("hidden");}
else{document.getElementById("fullRegisterBlock").classList.add("hidden");document.getElementById("loginOnlyBlock").classList.remove("hidden");}}
showAuth();

registerBtn.onclick=()=>{const m=regMobile.value.trim();if(!m)return authMsg.innerText="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï";if(users[m])return authMsg.innerText="User already exists";users[m]={mobile:m,name:regName.value||m,parent:regParent.value||null,balance:0,children:[],bank:{}};if(users[regParent.value])users[regParent.value].children.push(m);me={mobile:m,name:users[m].name};save();enterApp();}
registerCancelBtn.onclick=()=>showAuth();
loginOnlyBtn.onclick=()=>{const m=loginMobile.value.trim();if(users[m]){me={mobile:m,name:users[m].name};save();enterApp();}else authMsg.innerText="User ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ";};

function enterApp(){authCard.classList.add("hidden");openSection("wallet");updateWallet();}

function updateWallet(){if(!me)return;document.getElementById("bal").innerText=users[me.mobile].balance.toFixed(2);}
document.getElementById("addBtn").onclick=()=>{const v=parseFloat(document.getElementById("addAmt").value||0);if(v>0){users[me.mobile].balance+=v;updateWallet();save();}}
document.getElementById("transferBtn").onclick=()=>{const to=document.getElementById("t_mobile").value.trim();const amt=parseFloat(document.getElementById("t_amount").value||0);const msg=document.getElementById("transferMsg");if(!users[to])return msg.innerText="User ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ";if(users[me.mobile].balance<amt)return msg.innerText="‡§ï‡§Æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏";users[me.mobile].balance-=amt;users[to].balance+=amt;msg.style.color="green";msg.innerText="Transferred!";updateWallet();save();setTimeout(()=>msg.innerText="",1500);}
document.getElementById("withdrawBtn").onclick=()=>{const u=users[me.mobile];if(!u.bank||!u.bank.name)return alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§¨‡•à‡§Ç‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç");if(u.balance<=0)return alert("No balance");const a=parseFloat(prompt("Withdraw ‚Çπ amount"));if(a>0&&a<=u.balance){const fee=Math.round(a*0.1);u.balance-=a;withdraws.push({mobile:me.mobile,amount:a,fee,status:"pending"});save();alert("Request sent, 10% fee ‡§≤‡§æ‡§ó‡•Ç");updateWallet();}}

document.getElementById("saveBankBtn").onclick=()=>{const b={name:bank_name.value.trim(),account:bank_acc.value.trim(),ifsc:bank_ifsc.value.trim(),upi:bank_upi.value.trim()};users[me.mobile].bank=b;save();document.getElementById("bankMsg").innerText="Bank details saved!";setTimeout(()=>document.getElementById("bankMsg").innerText="",1500);}

function updateLoggedAs(){document.getElementById("loggedAs").innerText=me?`Logged: ${me.name}`:"Not logged";}
updateLoggedAs();
if(me)enterApp();
</script>
</body>
</html>
