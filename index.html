<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RJ Papad Registration</title>
<style>
body {
  margin:0;
  font-family: "Poppins", sans-serif;
  background:#fff8dc;
  text-align:center;
}

/* Hidden sections control */
#logoPage, #mainPage { display:none; }

.card {
  background:white;
  max-width:400px;
  margin:40px auto;
  padding:20px;
  border-radius:12px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
}
input {
  width:100%;
  padding:10px;
  margin:10px 0;
  border:1px solid #ccc;
  border-radius:8px;
}
button {
  background:#ffb300;
  border:none;
  color:white;
  padding:10px 16px;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
  width:100%;
}
#logoPage {
  background:#fff;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.logo {
  max-width:500px;
  width:90%;
  border-radius:12px;
  box-shadow:0 2px 10px rgba(0,0,0,0.1);
}
.banner {
  background:#fff3cd;
  border-radius:8px;
  margin:10px;
  padding:10px;
  font-weight:bold;
}
</style>
</head>
<body>

<!-- Registration Form -->
<div id="registerPage" class="card">
  <h2>रजिस्टर करें (Mobile Number से)</h2>
  <input type="text" id="userName" placeholder="नाम (वैकल्पिक)">
  <input type="text" id="userMobile" placeholder="मोबाइल नंबर (अनिवार्य)">
  <button onclick="registerUser()">रजिस्टर करें</button>
  <p id="regMsg" style="color:green;font-weight:bold;"></p>
</div>

<!-- Logo Page -->
<div id="logoPage">
  <img class="logo" src="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_0000000040986208ae9fdd85a3a3cbc8.png" alt="RJ Papad Logo">
  <button onclick="goToMain()">अगला पेज ➜</button>
</div>

<!-- Main Content -->
<div id="mainPage">
  <div class="banner" id="banner1">Top Banner (हिंदी)</div>
  <div class="banner" id="banner2">Bottom Banner (हिंदी)</div>
  <p style="margin-top:20px;">Welcome to RJ Papad Loyalty Program!</p>
</div>

<script>
/* CONFIGURATION: Replace below with your actual Google Script URL */
const SHEET_WEBHOOK_URL = "YOUR_SCRIPT_URL_HERE";
const SHEET_SECRET = "rj_secret_2025_xyz";

/* Step 1: Registration Flow */
function registerUser(){
  const name=document.getElementById("userName").value.trim();
  const mobile=document.getElementById("userMobile").value.trim();
  if(!mobile){
    alert("कृपया मोबाइल नंबर दर्ज करें!");
    return;
  }

  // Auto save locally
  localStorage.setItem("rj_name",name);
  localStorage.setItem("rj_mobile",mobile);

  // Send to Google Sheet (background)
  saveToGoogleSheet("register",mobile,name);

  // Show logo page
  document.getElementById("registerPage").style.display="none";
  document.getElementById("logoPage").style.display="flex";
  document.getElementById("regMsg").textContent="";
}

/* Step 2: After logo button */
function goToMain(){
  document.getElementById("logoPage").style.display="none";
  document.getElementById("mainPage").style.display="block";
}

/* Step 3: Auto-load saved user */
window.onload=function(){
  const mob=localStorage.getItem("rj_mobile");
  if(mob){
    // if already registered, go to logo page directly
    document.getElementById("registerPage").style.display="none";
    document.getElementById("logoPage").style.display="flex";
  } else {
    // show register form
    document.getElementById("registerPage").style.display="block";
  }
}

/* Google Sheet POST */
async function saveToGoogleSheet(action,mobile,name){
  if(!SHEET_WEBHOOK_URL.includes("http")){
    console.log("⚠️ No webhook set");
    return;
  }
  try{
    const res=await fetch(SHEET_WEBHOOK_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        secret:SHEET_SECRET,
        action, user_mobile:mobile, user_name:name, language:"Hindi"
      })
    });
    console.log("Saved:",await res.text());
  }catch(e){console.log(e);}
}
</script>
</body>
</html>
