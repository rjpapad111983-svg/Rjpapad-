<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RJ Papad Loyalty Wallet (Final with Banners)</title>
<style>
:root {
  --bg: #fff8dc;
  --accent: #ffb300;
  --card: #fff;
  --muted: #666;
}
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, Segoe UI, Roboto, "Noto Sans", sans-serif;
  background: var(--bg);
  color: #222;
  text-align: center;
}
.overlay {
  position: fixed;
  left: 0; top: 0; width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  padding: 20px; box-sizing: border-box;
  background: #fff;
  z-index: 10;
}
.panel {
  background: var(--card);
  max-width: 420px; width: 100%;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  padding: 22px; box-sizing: border-box;
}
h2 {margin: 0 0 12px; color: #c47d04; font-size: 20px;}
input {width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 15px;}
button {cursor: pointer; border: 0; border-radius: 10px; padding: 12px 16px; font-weight: 700; width: 100%;}
.btn-primary {background: var(--accent); color: #111;}
.btn-secondary {background: #eee; color: #222;}
.logo-full {display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 18px; height: 100%; background: #fff;}
.logo-full img {max-width: 90%; width: 420px; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.08);}
.lang-row {display: flex; gap: 8px; justify-content: center;}
.lang-btn {padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.06); background: transparent; cursor: pointer;}
.lang-btn.active {background: var(--accent); color: #fff;}
/* banner container wraps image */
.banner {
  display: block;
  background: #fff7e6;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid rgba(0,0,0,0.05);
  font-weight: 700;
  margin: 12px auto;
  text-align: center;
  max-width: 980px;
  box-sizing: border-box;
}
/* image style for banner */
.banner img {
  width: 100%;
  height: auto;
  max-width: 980px;
  border-radius: 8px;
  display: block;
  margin: 0 auto;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}
.wallet {
  background: #fff3cd;
  border-radius: 10px;
  padding: 15px;
  margin: 14px auto;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  max-width: 480px;
}
.amount {font-size: 28px; font-weight: 700; color: #008000;}
#transferBox {
  display: none;
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  align-items: center; justify-content: center;
  z-index: 50;
}
#transferPanel {
  background: #fff; padding: 20px; border-radius: 12px;
  max-width: 320px; width: 90%; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
}
@media(max-width:520px){
  .panel{padding:14px}
  .logo-full img{width:90%}
  h2{font-size:18px}
  .banner{margin:10px 10px}
  .wallet{margin:10px}
}
</style>
</head>
<body>

<!-- REGISTER PAGE -->
<div id="registerPage" class="overlay">
  <div class="panel">
    <h2>‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</h2>
    <input id="regName" type="text" placeholder="‡§®‡§æ‡§Æ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)">
    <input id="regMobile" type="tel" inputmode="numeric" maxlength="10" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï)">
    <button id="btnRegister" class="btn-primary">‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
    <p id="regError" style="color:red;font-size:13px;"></p>
  </div>
</div>

<!-- LOGIN PAGE -->
<div id="loginPage" class="overlay" style="display:none;">
  <div class="panel">
    <h2>‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç</h2>
    <input id="loginMobile" type="tel" inputmode="numeric" maxlength="10" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï)">
    <button id="btnLogin" class="btn-primary">‡§≤‡•â‡§ó‡§ø‡§®</button>
    <p id="loginError" style="color:red;font-size:13px;"></p>
  </div>
</div>

<!-- LOGO PAGE -->
<div id="logoPage" class="overlay" style="display:none;">
  <div class="logo-full">
    <img src="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_0000000040986208ae9fdd85a3a3cbc8.png" alt="RJ Papad Logo">
    <div class="lang-row">
      <button class="lang-btn active" data-lang="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
      <button class="lang-btn" data-lang="en">English</button>
      <button class="lang-btn" data-lang="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</button>
    </div>
    <button id="btnNext" class="btn-primary" style="width:auto;padding:10px 30px;">‡§Ö‡§ó‡§≤‡§æ ‡§™‡•á‡§ú ‚ûú</button>
  </div>
</div>

<!-- MAIN PAGE -->
<div id="mainPage" style="display:none;">
  <!-- TOP BANNER IMAGE (from your provided link) -->
  <div id="bannerTop" class="banner" aria-hidden="false">
    <img id="bannerTopImg" src="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_00000000de7861faafb1b8052e9bd122%20(1).png" alt="Top Banner">
  </div>

  <div class="wallet">
    <h2 id="walletTitle">üí∞ ‡§µ‡•â‡§≤‡•á‡§ü ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏</h2>
    <p id="walletMobile">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: ‚Äî</p>
    <p>‡§ï‡•Å‡§≤ ‡§∞‡§æ‡§∂‡§ø:</p>
    <div id="walletAmount" class="amount">‚Çπ0</div>
    <button id="addMoney" class="btn-primary">+ ‚Çπ10 ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
    <button id="transferMoney" class="btn-secondary" style="margin-top:8px;">‡§∞‡§ï‡§Æ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§ï‡§∞‡•á‡§Ç ‚ûú</button>
  </div>

  <!-- BOTTOM BANNER IMAGE (from your provided link) -->
  <div id="bannerBottom" class="banner" aria-hidden="false">
    <img id="bannerBottomImg" src="https://raw.githubusercontent.com/rjpapad111983-svg/Rjpapad-/refs/heads/main/file_00000000aac061fdacd52dbbf8a83410.png" alt="Bottom Banner">
  </div>

  <p id="welcomeText" style="font-weight:600;margin-top:20px;">RJ ‡§™‡§æ‡§™‡§°‡§º ‡§≤‡•â‡§Ø‡§≤‡•ç‡§ü‡•Ä ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!</p>
  <button id="btnLogout" class="btn-secondary" style="max-width:200px;margin:20px auto;">Logout</button>
</div>

<!-- TRANSFER POPUP -->
<div id="transferBox">
  <div id="transferPanel">
    <h3>üí∏ ‡§∞‡§ï‡§Æ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§ï‡§∞‡•á‡§Ç</h3>
    <input id="transferMobile" type="tel" inputmode="numeric" maxlength="10" placeholder="‡§∞‡§ø‡§∏‡•Ä‡§µ‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞">
    <input id="transferAmount" type="number" placeholder="‡§∞‡§ï‡§Æ (‚Çπ)">
    <button id="sendMoney" class="btn-primary">‡§≠‡•á‡§ú‡•á‡§Ç</button>
    <button id="closeTransfer" class="btn-secondary" style="margin-top:8px;">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
    <p id="transferMsg" style="font-size:13px;color:green;"></p>
  </div>
</div>

<script>
/* ========== CONFIG: Replace these with your values ========== */
const SHEET_WEBHOOK_URL = "YOUR_SCRIPT_URL_HERE"; // example: "https://script.google.com/macros/s/AKfycb.../exec"
const SHEET_SECRET = "rj_secret_2025_xyz";
/* ========================================================= */

const KEY_MOBILE="rj_mobile", KEY_NAME="rj_name", KEY_AMOUNT="rj_amount";
const el = id => document.getElementById(id);

const regP = el('registerPage'), logP = el('loginPage'), logoP = el('logoPage'), mainP = el('mainPage');
const regErr = el('regError'), loginErr = el('loginError');

let currentLang = "hi";

/* Language texts */
const LANG = {
  hi:{topText:"üü° ‡§ü‡•â‡§™ ‡§¨‡•à‡§®‡§∞ (‡§π‡§ø‡§Ç‡§¶‡•Ä)",bottomText:"üü° ‡§¨‡•â‡§ü‡§Æ ‡§¨‡•à‡§®‡§∞ (‡§π‡§ø‡§Ç‡§¶‡•Ä)",welcome:"RJ ‡§™‡§æ‡§™‡§°‡§º ‡§≤‡•â‡§Ø‡§≤‡•ç‡§ü‡•Ä ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!",wallet:"üí∞ ‡§µ‡•â‡§≤‡•á‡§ü ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏"},
  en:{topText:"üü° Top Banner (English)",bottomText:"üü° Bottom Banner (English)",welcome:"Welcome to RJ Papad Loyalty Program!",wallet:"üí∞ Wallet Balance"},
  gu:{topText:"üü° ‡™â‡™™‡™∞‡™®‡´ã ‡™¨‡´á‡™®‡™∞ (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)",bottomText:"üü° ‡™®‡´Ä‡™ö‡´á‡™®‡´ã ‡™¨‡´á‡™®‡™∞ (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)",welcome:"RJ ‡™™‡™æ‡™™‡™° ‡™≤‡´ã‡™Ø‡™≤‡´ç‡™ü‡´Ä ‡™™‡´ç‡™∞‡´ã‡™ó‡´ç‡™∞‡™æ‡™Æ‡™Æ‡™æ‡™Ç ‡™Ü‡™™‡™®‡´Å‡™Ç ‡™∏‡´ç‡™µ‡™æ‡™ó‡™§ ‡™õ‡´á!",wallet:"üí∞ ‡™µ‡´ã‡™≤‡´á‡™ü ‡™¨‡´á‡™≤‡´á‡™®‡´ç‡™∏"}
};

/* Set language UI (text + ensure banners stay visible) */
function setLang(l){
  currentLang = l;
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  const btn = document.querySelector(`.lang-btn[data-lang="${l}"]`);
  if(btn) btn.classList.add('active');

  // we keep banners as images (links). For accessibility/update alt/title we can set attributes:
  el('bannerTop').setAttribute('aria-label', LANG[l].topText);
  el('bannerBottom').setAttribute('aria-label', LANG[l].bottomText);
  el('welcomeText').textContent = LANG[l].welcome;
  el('walletTitle').textContent = LANG[l].wallet;

  // Ensure banners are visible (force)
  el('bannerTop').style.display = 'block';
  el('bannerBottom').style.display = 'block';
}

/* Wire language buttons */
document.querySelectorAll('.lang-btn').forEach(b=>b.addEventListener('click', ()=> setLang(b.dataset.lang)));

/* REGISTER */
el('btnRegister').addEventListener('click', async ()=>{
  const name = el('regName').value.trim();
  const mob = el('regMobile').value.trim();
  if(!/^[0-9]{10}$/.test(mob)){
    regErr.textContent = "‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç";
    return;
  }
  localStorage.setItem(KEY_MOBILE, mob);
  localStorage.setItem(KEY_NAME, name);
  localStorage.setItem(KEY_AMOUNT, "0");
  regErr.textContent = "";
  // remote save (non-blocking)
  await saveToSheet("register", mob, name, 0);
  // show login page
  regP.style.display = "none";
  logP.style.display = "flex";
});

/* LOGIN */
el('btnLogin').addEventListener('click', ()=>{
  const mob = el('loginMobile').value.trim();
  const saved = localStorage.getItem(KEY_MOBILE);
  if(!/^[0-9]{10}$/.test(mob)){ loginErr.textContent = "‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç"; return; }
  if(mob !== saved){ loginErr.textContent = "‡§Ø‡§π ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à"; return; }
  loginErr.textContent = "";
  logP.style.display = "none";
  logoP.style.display = "flex";
});

/* LOGO ‚Üí MAIN */
el('btnNext').addEventListener('click', ()=> {
  logoP.style.display = "none";
  showMain();
});

/* showMain ensures banners visible and wallet updated */
function showMain(){
  // explicitly ensure banner images exist and are visible
  el('bannerTop').style.display = 'block';
  el('bannerBottom').style.display = 'block';

  // make main visible
  mainP.style.display = 'block';

  // update wallet display
  updateWallet();

  // small safe scroll to top on mobile so top banner is visible
  window.scrollTo({ top: 0, behavior: 'instant' });
}

/* ADD MONEY */
el('addMoney').addEventListener('click', ()=>{
  let amt = parseInt(localStorage.getItem(KEY_AMOUNT) || "0");
  amt += 10;
  localStorage.setItem(KEY_AMOUNT, String(amt));
  el('walletAmount').textContent = "‚Çπ" + amt;
  // remote record
  saveToSheet("add_money", localStorage.getItem(KEY_MOBILE), localStorage.getItem(KEY_NAME), amt);
});

/* TRANSFER HANDLERS */
const tBox = el('transferBox');
el('transferMoney').addEventListener('click', ()=> { tBox.style.display = "flex"; el('transferMobile').value = ''; el('transferAmount').value = ''; el('transferMsg').textContent = ''; });
el('closeTransfer').addEventListener('click', ()=> { tBox.style.display = "none"; el('transferMsg').textContent = ''; });

el('sendMoney').addEventListener('click', ()=>{
  const sender = localStorage.getItem(KEY_MOBILE) || "";
  let balance = parseInt(localStorage.getItem(KEY_AMOUNT) || "0");
  const recv = el('transferMobile').value.trim();
  const val = parseInt(el('transferAmount').value.trim() || "0");
  if(!/^[0-9]{10}$/.test(recv)){ el('transferMsg').textContent = "‚ö†Ô∏è ‡§∏‡§π‡•Ä ‡§∞‡§ø‡§∏‡•Ä‡§µ‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§°‡§æ‡§≤‡•á‡§Ç"; el('transferMsg').style.color = "red"; return; }
  if(val <= 0){ el('transferMsg').textContent = "‚ö†Ô∏è ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç"; el('transferMsg').style.color = "red"; return; }
  if(val > balance){ el('transferMsg').textContent = "‚ùå ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç"; el('transferMsg').style.color = "red"; return; }

  balance -= val;
  localStorage.setItem(KEY_AMOUNT, String(balance));
  el('walletAmount').textContent = "‚Çπ" + balance;
  el('transferMsg').style.color = "green";
  el('transferMsg').textContent = "‚úÖ ‚Çπ" + val + " ‡§≠‡•á‡§ú‡•Ä ‡§ó‡§à " + recv + " ‡§ï‡•ã";

  // record transfer on sheet (include toMobile & toAmount)
  saveToSheet("transfer", sender, localStorage.getItem(KEY_NAME) || "", balance, recv, val);

  setTimeout(()=> { tBox.style.display = "none"; el('transferMsg').textContent = ""; }, 1400);
});

/* LOGOUT */
el('btnLogout').addEventListener('click', ()=>{
  mainP.style.display = "none";
  logP.style.display = "flex";
});

/* UPDATE WALLET UI */
function updateWallet(){
  const mob = localStorage.getItem(KEY_MOBILE) || "‚Äî";
  const amt = parseInt(localStorage.getItem(KEY_AMOUNT) || "0");
  el('walletMobile').textContent = "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: " + mob;
  el('walletAmount').textContent = "‚Çπ" + amt;
}

/* Save to Google Sheet helper */
async function saveToSheet(action, mobile, name, amount, toMobile, toAmount){
  if(!SHEET_WEBHOOK_URL || !SHEET_WEBHOOK_URL.startsWith("http")) { console.log("Webhook not configured"); return; }
  const payload = { secret: SHEET_SECRET, action, user_mobile: mobile, user_name: name, language: currentLang };
  if(typeof amount !== "undefined") payload.amount = amount;
  if(typeof toMobile !== "undefined") payload.toMobile = toMobile;
  if(typeof toAmount !== "undefined") payload.toAmount = toAmount;
  try{
    const resp = await fetch(SHEET_WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    const txt = await resp.text();
    console.log("Sheet response:", txt);
  }catch(e){
    console.warn("Sheet save failed", e);
  }
}

/* INITIAL LOAD */
window.addEventListener('DOMContentLoaded', ()=>{
  setLang("hi"); // default language and ensures banners visible
  // always start with register as you requested
  regP.style.display = "flex";
  logP.style.display = "none";
  logoP.style.display = "none";
  mainP.style.display = "none";

  // ensure image elements loaded (preload) to avoid flicker
  const topImg = el('bannerTopImg'), botImg = el('bannerBottomImg');
  if(topImg) topImg.onload = ()=> { el('bannerTop').style.display = 'block'; };
  if(botImg) botImg.onload = ()=> { el('bannerBottom').style.display = 'block'; };
});
</script>
</body>
</html>
